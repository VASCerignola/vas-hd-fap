<!doctype html>
<html lang="it">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>VAS-HD (FAP)</title>

<link rel="manifest" href="manifest.webmanifest">
<meta name="theme-color" content="#c86a9a">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

<style>
:root{
  --bg:#120b10;
  --card:#1b0f17;
  --line:#6b2b4a;
  --txt:#f2e9ee;
  --mut:#d6b3c4;
  --accent:#c86a9a;
}

body{
  margin:0;
  font-family:-apple-system,system-ui,Segoe UI,Roboto;
  background:var(--bg);
  color:var(--txt);
}

header{
  padding:14px;
  border-bottom:1px solid var(--line);
}

h1{
  margin:0;
  font-size:20px;
}

small{color:var(--mut)}

main{
  padding:14px;
  max-width:980px;
  margin:0 auto;
}

.card{
  background:linear-gradient(180deg,rgba(255,255,255,.04),rgba(255,255,255,.01));
  border:1px solid var(--line);
  border-radius:14px;
  padding:14px;
  margin-bottom:12px;
}

.grid{
  display:grid;
  grid-template-columns:1fr;
  gap:10px;
}

@media(min-width:780px){
  .grid{grid-template-columns:1fr 1fr}
}

label{
  font-size:12px;
  color:var(--mut);
  display:block;
  margin-bottom:6px;
}

select,input{
  width:100%;
  padding:12px;
  border-radius:12px;
  border:1px solid var(--line);
  background:#0f0a0d;
  color:var(--txt);
}

.row{
  display:flex;
  gap:10px;
}

.btn{
  width:100%;
  padding:14px;
  border-radius:14px;
  border:0;
  font-weight:900;
  background:var(--accent);
  color:white;
}

.btn2{
  width:100%;
  padding:14px;
  border-radius:14px;
  border:1px solid var(--line);
  font-weight:900;
  background:transparent;
  color:var(--txt);
}

.badge{
  display:inline-block;
  padding:6px 12px;
  border-radius:999px;
  font-weight:900;
  color:white;
}

.g0{background:#3b7d5b}
.g1{background:#b58b2a}
.g2{background:#c46a2d}
.g3{background:#b11226}

hr{
  border:0;
  border-top:1px solid var(--line);
  margin:12px 0;
}

.mono{
  font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;
  color:var(--mut);
  font-size:12px;
  white-space:pre-wrap;
}

.hidden{display:none}
</style>
</head>

<body>
<header>
  <h1>VAS-HD (FAP)</h1>
  <small>Vascular Access Surveillance in Hemodialysis</small>
</header>

<main>

<section id="home">
  <div class="card">
    <b>Versione reparto</b>
    <p style="color:var(--mut);margin:8px 0 0">
      Checklist clinica essenziale con grading automatico.
    </p>
  </div>
  <button class="btn" onclick="go('form')">NUOVA SEDUTA</button>
</section>

<section id="form" class="hidden">
  <div class="card">
    <b>Dati seduta</b>

    <div class="grid" style="margin-top:10px">
      <div>
        <label>Tipo accesso</label>
        <select id="accesso" onchange="toggleCVC()">
          <option>FAV</option>
          <option>AVG</option>
          <option>CVC</option>
        </select>
      </div>

      <div>
        <label>Puntura</label>
        <select id="puntura">
          <option>Facile</option>
          <option>Difficile</option>
          <option>Impossibile</option>
        </select>
      </div>

      <div>
        <label>Thrill</label>
        <select id="thrill">
          <option>Normale</option>
          <option>Ridotto</option>
          <option>Assente</option>
        </select>
      </div>

      <div>
        <label>Bruit</label>
        <select id="bruit">
          <option>Normale</option>
          <option>Alto-pitch</option>
          <option>Assente</option>
        </select>
      </div>

      <div>
        <label>Qb prescritto</label>
        <input id="qbPres" type="number" value="300">
      </div>

      <div>
        <label>Qb ottenuto</label>
        <input id="qbOtt" type="number" value="300">
      </div>

      <div>
        <label>Allarmi</label>
        <select id="allarmi">
          <option>No</option>
          <option>Arteriosi</option>
          <option>Venosi</option>
          <option>Entrambi</option>
        </select>
      </div>

      <div>
        <label>Seduta completata</label>
        <select id="completata">
          <option>Sì</option>
          <option>No</option>
        </select>
      </div>

      <div>
        <label>Trombosi sospetta</label>
        <select id="trombosi">
          <option>No</option>
          <option>Sì</option>
        </select>
      </div>

      <div>
        <label>Segni infezione</label>
        <select id="infezione">
          <option>No</option>
          <option>Sì</option>
        </select>
      </div>
    </div>

    <div id="cvcBox" class="hidden" style="margin-top:12px">
      <hr>
      <b>CVC</b>
      <div class="grid" style="margin-top:10px">
        <div>
          <label>Exit-site</label>
          <select id="exit">
            <option>OK</option>
            <option>Arrossato</option>
            <option>Essudato</option>
          </select>
        </div>
        <div>
          <label>Febbre</label>
          <select id="febbre">
            <option>No</option>
            <option>Sì</option>
          </select>
        </div>
      </div>
    </div>

    <hr>

    <div class="row">
      <button class="btn2" onclick="go('home')">ANNULLA</button>
      <button class="btn" onclick="calcola()">CALCOLA GRADING</button>
    </div>
  </div>
</section>

<section id="result" class="hidden">
  <div class="card">
    <b>Esito</b>
    <div style="margin-top:10px">
      <span id="badge" class="badge g0">G0</span>
      <div id="titolo" style="font-weight:900;font-size:18px;margin-top:10px">Routine</div>
      <div id="azione" style="margin-top:6px">Accesso stabile.</div>
    </div>
  </div>

  <div class="row">
    <button class="btn2" onclick="go('form')">MODIFICA</button>
    <button class="btn" onclick="go('home')">NUOVA</button>
  </div>
</section>

<script>
if('serviceWorker' in navigator){navigator.serviceWorker.register('sw.js')}

function go(id){
  ['home','form','result'].forEach(s=>document.getElementById(s).classList.add('hidden'));
  document.getElementById(id).classList.remove('hidden');
}

function toggleCVC(){
  document.getElementById('cvcBox').classList.toggle(
    'hidden',
    document.getElementById('accesso').value!=='CVC'
  );
}

function calcola(){
  let grade=0;
  if(document.getElementById('thrill').value==='Assente') grade=3;
  if(document.getElementById('puntura').value==='Impossibile') grade=3;

  const map=[
    ['g0','Routine','Accesso stabile.'],
    ['g1','Warning','Ricontrollo prossima seduta.'],
    ['g2','Disfunzione probabile','Eco accesso entro 72h.'],
    ['g3','Critico','Gestione urgente oggi.']
  ];

  document.getElementById('badge').className='badge '+map[grade][0];
  document.getElementById('badge').textContent='G'+grade;
  document.getElementById('titolo').textContent=map[grade][1];
  document.getElementById('azione').textContent=map[grade][2];

  go('result');
}

toggleCVC();
</script>

</main>
</body>
</html>
